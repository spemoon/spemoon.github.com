<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.0.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.0.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.0.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.0.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.0.0" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="人在江湖漂">
<meta property="og:url" content="http://yoursite.com/archives/index.html">
<meta property="og:site_name" content="人在江湖漂">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="人在江湖漂">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '6.0.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/archives/"/>





  <title>人在江湖漂</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> <div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">人在江湖漂</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            

            
              首页
            

          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            

            
              归档
            

          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/12/07/nodejs-note-global-objects/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SpeMoon">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="人在江湖漂">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/12/07/nodejs-note-global-objects/" itemprop="url">Node.js学习笔记——Global Objects 全局对象</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2011-12-07T00:00:00+08:00">2011-12-07</time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/javascript/" itemprop="url" rel="index">
                    <span itemprop="name">javascript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="global"><a href="#global" class="headerlink" title="global"></a>global</h3><p>在浏览器中，顶级作用域为全局作用域，在全局作用域下通过var something即定义了一个全局变量。但是在Node中并不如此，顶级作用域并非是全局作用域，在Node模块中通过var something定义的变量仅作用于该模块。</p>
<h3 id="require-resolve"><a href="#require-resolve" class="headerlink" title="require.resolve()"></a>require.resolve()</h3><p>使用内部函数require()的机制查找一个模块的位置，而不用加载模块，只是返回解析后的文件名。</p>
<h3 id="require-paths"><a href="#require-paths" class="headerlink" title="require.paths"></a>require.paths</h3><p>require()的搜索路径数组，你可以修改该数组添加自定义的搜索路径。</p>
<p>例如：将一个新的搜索路径插入到搜索列表的头部。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>.paths.unshift(<span class="string">'/usr/local/node'</span>);</span><br></pre></td></tr></table></figure></p>
<h3 id="filename"><a href="#filename" class="headerlink" title="__filename"></a>__filename</h3><p>当前正在执行的脚本的文件名。这是一个绝对路径，可能会和命令行参数中传入的文件名不同。</p>
<p>例如：在目录/Users/mjr下运行node example.js<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(__filename);</span><br><span class="line"><span class="comment">// /Users/mjr/example.js</span></span><br></pre></td></tr></table></figure></p>
<h3 id="dirname"><a href="#dirname" class="headerlink" title="__dirname"></a>__dirname</h3><p>当前正在执行脚本所在的目录名。</p>
<p>例如：在目录/Users/mjr下运行node example.js<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(__dirname);</span><br><span class="line"><span class="comment">// /Users/mjr</span></span><br></pre></td></tr></table></figure></p>
<h3 id="module"><a href="#module" class="headerlink" title="module"></a>module</h3><p>指向当前模块的引用。特别的，当你通过module.exports和exports两种方式访问的将是同一个对象，参见src/node.js。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/12/05/node/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SpeMoon">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="人在江湖漂">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/12/05/node/" itemprop="url">折腾Node.js</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2011-12-05T00:00:00+08:00">2011-12-05</time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/javascript/" itemprop="url" rel="index">
                    <span itemprop="name">javascript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>前段时间在折腾Node.js。刚刚入门，啥都不懂，写篇东西记录下自己碰到的问题。</p>
<p>谷歌的blog被墙了，故得搬过来=。=</p>
<p>说起Node.js，不得不提到git。</p>
<p>git的使用可以去看它的官网的<a href="http://help.github.com/linux-set-up-git/" target="_blank" rel="noopener">帮助手册</a></p>
<p>接着就是Node.js了，大头的来了</p>
<p>第一步：安装依赖包</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>安装 python2<span class="number">.6</span>或者更高</span><br><span class="line"><span class="number">2.</span>sudo apt-get install g++ curl libssl-dev apache2-utils</span><br><span class="line"><span class="number">3.</span>sudo apt-get install git-core</span><br></pre></td></tr></table></figure>
<p>第二步：获取源码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone git:<span class="comment">//github.com/joyent/node.git</span></span><br></pre></td></tr></table></figure>
<p>第三步：指定编译版本，这个比较关键</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>cd node</span><br><span class="line"><span class="number">2.</span>git checkout v0<span class="number">.4</span><span class="number">.10</span>  （这里比较重要，目前很多常用的包只支持到<span class="number">0.4</span><span class="number">.10</span>，如express，所以如果用最新的版本的话，会导致npm无法下载相应的包）</span><br><span class="line"><span class="number">3.</span>指定路径，编译执行</span><br><span class="line">mkdir ~<span class="regexp">/local</span></span><br><span class="line"><span class="regexp">./</span>configure -prefix=$HOME/local/node</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">echo <span class="string">'export PATH=$HOME/local/node/bin:$PATH'</span>&gt;&gt; ~<span class="regexp">/.profile</span></span><br><span class="line"><span class="regexp">echo 'export NODE_PATH=$HOME/</span>local/node:$HOME/local/node/lib/node_modules<span class="string">'&gt;&gt; ~/.profile</span></span><br><span class="line"><span class="string">source ~/.profile</span></span><br></pre></td></tr></table></figure>
<p>第四步：设置环境变量</p>
<p>如果想重启后还能继续直接使用node命令,那么需要设置环境变量:<br>使用命令 sudo gedit /etc/profile 打开配置文件，在文件最后中添加如下两行：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> PATH=”$HOME/local/node/bin:$PATH”</span><br><span class="line"><span class="keyword">export</span> NODE_PATH=”$HOME/local/node:$HOME/local/node/lib/node_modules”</span><br></pre></td></tr></table></figure></p>
<p>保存后重启系统使设置生效。</p>
<p>第五步：安装npm (这里注意可能需要翻墙来安装)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">curl http:<span class="comment">//npmjs.org/install.sh | sh</span></span><br><span class="line">根据需要，安装相应的包，例如express：</span><br><span class="line">npm install express</span><br><span class="line">如果输入该命令后长时间没有反应，可以通过添加 -verbose参数查看执行的详细信息，即：</span><br><span class="line">npm install express -verbose</span><br><span class="line">一般情况下无法下载有两个原因：</span><br><span class="line"><span class="number">1.</span> 网速太慢，超时退出。</span><br><span class="line"><span class="number">2.</span> node的版本太新，当前下载的包不支持。（解决方法在第三步已说明。）</span><br></pre></td></tr></table></figure>
<p>如果被墙了，可以用SSH翻墙后，用proxychains来执行，当然还得先装个proxychains(详见附录)。</p>
<pre><code>安装完proxychains后可用命令proxychains npm install  XXX，来安装node相应的包。

搞定后你可以先跑个helloworld例子看一下，这个例子网上到处都有，就不贴了=。=
附录: proxychains安装方法如下：

ubuntu11.10下直接sudo apt-get install proxychains就可以安装了，其他版本的linux系统可以看看自己系统的软件包支持有木有，如果软件包更新中没有就点击这里去[proxychains官方下载最新的版本](http://sourceforge.net/projects/proxychains/files/proxychains/version%203.1/proxychains-3.1.tar.gz/download)。然后编译，具体编译方法可以看包中的INSTALL文件说明。

安装完成后我们需要对程序进行配置，配置文件是/etc/proxychains.conf，但是根据作者的说明，其实配置文件在三个地方都是有效的。

好了，既然配置文件已经找到了，我们就来看看配置文件的具体配置吧。proxychains的模式有三种

dynamic_chain，按照列表中出现的代理服务器的先后顺序组成一条链，如果有代理服务器失效，则自动将其排除，但至少要有一个是有效的。

strict_chain，按照后面列表中出现的代理服务器的先后顺序组成一条链，要求所有的代理服务器都是有效的

random_chain，列表中的任何一个代理服务器都可能被选择使用，这种方式很适合网络扫描操作（参数chain_len只对random_chain有效）。

默认是选择的strict_chain，因此这里我们不做改变。在最下方可以配置自己的代理，方式可以参照配置文件。例如
http 127.0.0.1 8080
</code></pre><p>socks5 127.0.0.1 7070 (ssh用这个配置就可以了)</p>
<pre><code>http 123.456.789.1 username passwd

呃，但是如果选择strict_chain的方式，建议就留一个可用的代理即可，要不会无法使用。ok，把配置文件放到你的用户目录下就可以了。配置文件在哪里？下载这个吧，可以直接用做ssh的配置，其它代理自己修改即可。[点此下载配置文件](http://yunfile.com/file/nenew/76c8efa9/)

执行程序的时候直接输入proxychains 程序名即可，比如打开火狐可以用 proxychains firefox。还有，启动个别程序的时候可能需要sudo权限。
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/11/10/ctrl-position/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SpeMoon">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="人在江湖漂">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/11/10/ctrl-position/" itemprop="url">获取光标的位置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2011-11-10T00:00:00+08:00">2011-11-10</time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/javascript/" itemprop="url" rel="index">
                    <span itemprop="name">javascript</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/javascript/position/" itemprop="url" rel="index">
                    <span itemprop="name">position</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>前段时间写一个<a href="http://momo.im" target="_blank" rel="noopener">MOMO</a>的表情组件，遇到一个问题，即确定当前光标的位置，主要用于textarea跟input中，下面将相关代码罗列如下。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> textareaHelper = &#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 获取光标的位置</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        getPostion : <span class="function"><span class="keyword">function</span>(<span class="params">node, iePos</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(node.setSelectionRange) &#123;</span><br><span class="line">                <span class="keyword">return</span> node.selectionStart;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">document</span>.selection) &#123;</span><br><span class="line">                <span class="keyword">if</span>( iePos === <span class="literal">true</span> )&#123;</span><br><span class="line">                    i = node.pos || <span class="number">0</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">var</span> i, sc = <span class="built_in">document</span>.selection.createRange(), bc = <span class="built_in">document</span>.body.createTextRange();</span><br><span class="line">                    bc.moveToElementText(node);</span><br><span class="line">                    <span class="keyword">for</span>(i = <span class="number">0</span>; bc.compareEndPoints(<span class="string">'StartToStart'</span>, sc) &lt; <span class="number">0</span> &amp;&amp; sc.moveStart(<span class="string">'character'</span>, <span class="number">-1</span>) !== <span class="number">0</span>; i++)&#123;</span><br><span class="line">                        <span class="keyword">if</span>(node.value.charAt(i) == <span class="string">'\n'</span>)&#123;</span><br><span class="line">                            i++;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 设置光标的位置</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        setPosition : <span class="function"><span class="keyword">function</span>(<span class="params">textarea, p</span>)</span>&#123;</span><br><span class="line">            p = p == <span class="string">'end'</span> ? textarea.value.length : p;</span><br><span class="line">            <span class="keyword">if</span>(textarea.setSelectionRange)&#123;</span><br><span class="line">                textarea.focus();</span><br><span class="line">                textarea.setSelectionRange(p, p);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (textarea.createTextRange) &#123;</span><br><span class="line">                <span class="keyword">var</span> range = textarea.createTextRange();</span><br><span class="line">                range.moveEnd(<span class="string">'character'</span>, -textarea.value.length);</span><br><span class="line">                range.moveEnd(<span class="string">'character'</span>, p);</span><br><span class="line">                range.moveEnd(<span class="string">'character'</span>, p);</span><br><span class="line">                range.select();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;    </span><br><span class="line"></span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/10/28/js-or-and/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SpeMoon">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="人在江湖漂">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/10/28/js-or-and/" itemprop="url">JS中的与（AND）、或（OR）工作原理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2011-10-28T00:00:00+08:00">2011-10-28</time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/javascript/" itemprop="url" rel="index">
                    <span itemprop="name">javascript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="先来看mozilla的javascript文档对逻辑与的定义："><a href="#先来看mozilla的javascript文档对逻辑与的定义：" class="headerlink" title="先来看mozilla的javascript文档对逻辑与的定义："></a>先来看mozilla的javascript文档对逻辑与的定义：</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">（逻辑与）若expr1可转换为<span class="literal">false</span>，则返回expr1；否则，返回expr2。因此，当使用布尔值时，若两个操作数都是<span class="literal">true</span>，则&amp;&amp;运算符返回<span class="literal">true</span>；否则，返回<span class="literal">false</span>。</span><br></pre></td></tr></table></figure>
<p>因此换言之，这意味着，若expr1为真，则expr1 &amp;&amp; expr2将返回expr2，否则将返回expr1。</p>
<p>注意：当逻辑与（&amp;&amp;）运算符与非布尔值（non Boolean Values）一起使用时，其运算结果不会返回“true”或“false”，而是返回两个表达式中的某一表达式本身。</p>
<p>那我们该怎么用呢？来接着看：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(a)&#123;</span><br><span class="line">    <span class="keyword">return</span> a.method();</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>根据&amp;&amp;的特性，我们可以将其改写为：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> a &amp;&amp; a.method();</span><br></pre></td></tr></table></figure>
<p>同样的，再来看逻辑或的定义：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">（逻辑或）若expr1可转换为<span class="literal">true</span>，则返回expr1；否则，返回expr2。因此，当使用布尔值时，若任一操作数是<span class="literal">true</span>，则||运算符返回<span class="literal">true</span>；若两个操作数都是<span class="literal">false</span>，返回<span class="literal">false</span>。</span><br></pre></td></tr></table></figure>
<p>所以我们可以利用其来以表达式风格来定义变量的缺省值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myVar = input || <span class="keyword">default</span>;</span><br></pre></td></tr></table></figure>
<p>当然代码如果都运用这些特性的话，可读性就相对会低一点了，对于新人来说，阅读起来会有困难，需要在开发过程中进行相应的取舍。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/10/25/ie-ff-js-script-compatible/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SpeMoon">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="人在江湖漂">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/10/25/ie-ff-js-script-compatible/" itemprop="url">IE与FF脚本兼容性问题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2011-10-25T00:00:00+08:00">2011-10-25</time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/javascript/" itemprop="url" rel="index">
                    <span itemprop="name">javascript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="getYear-方法"><a href="#getYear-方法" class="headerlink" title="getYear()方法"></a>getYear()方法</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> year = <span class="keyword">new</span> <span class="built_in">Date</span>().getYear();</span><br><span class="line"><span class="built_in">document</span>.write(year);</span><br></pre></td></tr></table></figure>
<p>在IE中得到的日期是”2010”，在Firefox中看到的日期是”110”，主要是因为在 Firefox 里面 getYear 返回的是 “当前年份-1900” 的值。</p><p></p>
<h5 id="【兼容处理】"><a href="#【兼容处理】" class="headerlink" title="【兼容处理】"></a>【兼容处理】</h5><p>加上对年份的判断，如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> year= <span class="keyword">new</span> <span class="built_in">Date</span>().getYear();</span><br><span class="line">year = (year&amp;lt;<span class="number">1900</span>?(<span class="number">1900</span>+year):year);</span><br><span class="line"><span class="built_in">document</span>.write(year);</span><br></pre></td></tr></table></figure>
<p>也可以通过 getFullYear getUTCFullYear 去调用:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> year = <span class="keyword">new</span> <span class="built_in">Date</span>().getFullYear();</span><br><span class="line"><span class="built_in">document</span>.write(year);</span><br></pre></td></tr></table></figure>
<h3 id="eval-函数"><a href="#eval-函数" class="headerlink" title="eval()函数"></a>eval()函数</h3><p>在IE中，可以使用eval(“idName”)或getElementById(“idName”)来取得id为idName的HTML对象；Firefox下只能使用getElementById(“idName”)来取得id为idName的HTML对象。</p>
<h5 id="【兼容处理】-1"><a href="#【兼容处理】-1" class="headerlink" title="【兼容处理】"></a>【兼容处理】</h5><p>统一用getElementById(“idName”)来取得id为idName的HTML对象。</p>
<h3 id="const声明"><a href="#const声明" class="headerlink" title="const声明"></a>const声明</h3><p>在 IE 中不能使用 const 关键字。如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> constVar = <span class="number">32</span>;</span><br></pre></td></tr></table></figure>
<p>在IE中这是语法错误。</p>
<h5 id="【兼容处理】-2"><a href="#【兼容处理】-2" class="headerlink" title="【兼容处理】"></a>【兼容处理】</h5><p>不使用 const ，以 var 代替。</p>
<h3 id="var"><a href="#var" class="headerlink" title="var"></a>var</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo=<span class="function"><span class="keyword">function</span>(<span class="params">str</span>)</span>&#123;</span><br><span class="line">   <span class="built_in">document</span>.write(str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个函数在IE上运行正常，Firefox下却报错了。</p>
<h5 id="【兼容处理】-3"><a href="#【兼容处理】-3" class="headerlink" title="【兼容处理】"></a>【兼容处理】</h5><p>而在echo前加上var就正常了，这个就是我们提到var的目的。</p>
<h3 id="CSS的”float”属性"><a href="#CSS的”float”属性" class="headerlink" title="CSS的”float”属性"></a>CSS的”float”属性</h3><p>Javascript访问一个给定CSS 值的最基本句法是：object.style.property，但部分CSS属性跟Javascript中的保留字命名相同，如”float”，”for”，”class”等，不同浏览器写法不同。</p>
<p>在IE中这样写：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"header"</span>).style.styleFloat = <span class="string">"left"</span>;</span><br></pre></td></tr></table></figure>
<p>在FF中这样写：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"header"</span>).style.cssFloat = <span class="string">"left"</span>;</span><br></pre></td></tr></table></figure>
<h5 id="【兼容处理】-4"><a href="#【兼容处理】-4" class="headerlink" title="【兼容处理】"></a>【兼容处理】</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="built_in">document</span>.all)&#123;</span><br><span class="line">　　<span class="built_in">document</span>.getElementById(<span class="string">"header"</span>).style.styleFloat = <span class="string">"left"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">　　<span class="built_in">document</span>.getElementById(<span class="string">"header"</span>).style.cssFloat = <span class="string">"left"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="访问-lt-label-gt-标签中的”for”"><a href="#访问-lt-label-gt-标签中的”for”" class="headerlink" title="访问&lt;label&gt;标签中的”for”"></a>访问&lt;label&gt;标签中的”for”</h3><p>和”float”属性一样，同样需要使用不现的句法区分来访问&lt;label&gt;标签中的”for”。</p>
<p>在IE中这样写：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myObject = <span class="built_in">document</span>.getElementById(<span class="string">"myLabel"</span>);</span><br><span class="line"><span class="keyword">var</span> myAttribute = myObject.getAttribute(<span class="string">"htmlFor"</span>);</span><br></pre></td></tr></table></figure>
<p>在FF中这样写：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myObject = <span class="built_in">document</span>.getElementById(<span class="string">"myLabel"</span>);</span><br><span class="line"><span class="keyword">var</span> myAttribute = myObject.getAttribute(<span class="string">"for"</span>);</span><br></pre></td></tr></table></figure>
<h5 id="【兼容处理】-5"><a href="#【兼容处理】-5" class="headerlink" title="【兼容处理】"></a>【兼容处理】</h5><p>解决的方法也是先 判断浏览器类型。</p>
<h3 id="访问和设置class属性"><a href="#访问和设置class属性" class="headerlink" title="访问和设置class属性"></a>访问和设置class属性</h3><p>同样由于class是Javascript保留字的原因，这两种浏览器使用不同的 JavaScript 方法来获取这个属性。</p>
<p>IE8.0之前的所有IE版本的写法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myObject = <span class="built_in">document</span>.getElementById(<span class="string">"header"</span>);</span><br><span class="line"><span class="keyword">var</span> myAttribute = myObject.getAttribute(<span class="string">"className"</span>);</span><br></pre></td></tr></table></figure>
<p>另外，在使用setAttribute()设置Class属性的时候，两种浏览器也存在同样的差异。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setAttribute(<span class="string">"className"</span>,value);</span><br></pre></td></tr></table></figure>
<p>这种写法适用于IE8.0之前的所有IE版本，注意：IE8.0也不支持”className”属性了。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setAttribute(<span class="string">"class"</span>,value);适用于IE8<span class="number">.0</span> 以及 firefox。</span><br></pre></td></tr></table></figure>
<h5 id="【兼容处理】-6"><a href="#【兼容处理】-6" class="headerlink" title="【兼容处理】"></a>【兼容处理】</h5><p>方法一，两种都写上：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myObject = <span class="built_in">document</span>.getElementById(<span class="string">"header"</span>);</span><br><span class="line">myObject.setAttribute(<span class="string">"class"</span>,<span class="string">"classValue"</span>);</span><br><span class="line">myObject.setAttribute(<span class="string">"className"</span>,<span class="string">"classValue"</span>);</span><br><span class="line"> <span class="comment">//设置header的class为classValue</span></span><br></pre></td></tr></table></figure>
<p>方法二，IE和FF都支持object.className，所以可以这样写：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myObject = <span class="built_in">document</span>.getElementById(<span class="string">"header"</span>);</span><br><span class="line">myObject.className=<span class="string">"classValue"</span>;<span class="comment">//设置header的class为classValue</span></span><br></pre></td></tr></table></figure>
<p>方法三，先判断浏览器类型，再根据浏览器类型采用对应的写法。</p>
<h3 id="对象宽高赋值问题"><a href="#对象宽高赋值问题" class="headerlink" title="对象宽高赋值问题"></a>对象宽高赋值问题</h3><p>FireFox中类似 obj.style.height = imgObj.height 的语句无效。</p>
<h5 id="【兼容处理】-7"><a href="#【兼容处理】-7" class="headerlink" title="【兼容处理】"></a>【兼容处理】</h5><p>统一使用 obj.style.height = imgObj.height + ‘px’;</p>
<h3 id="getElementById"><a href="#getElementById" class="headerlink" title="getElementById"></a>getElementById</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;lt;input id=<span class="string">"id"</span> type=<span class="string">"button"</span> value=<span class="string">"click me"</span> onclick=<span class="string">"alert(id.value)"</span>/&amp;gt;</span><br></pre></td></tr></table></figure>
<p>在Firefox中，按钮没反应，在IE中，就可以，因为对于IE来说，一个HTML 元素的 ID 可以直接在脚本中当作变量名来使用，而Firefox中不可以。</p>
<h5 id="【兼容处理】-8"><a href="#【兼容处理】-8" class="headerlink" title="【兼容处理】"></a>【兼容处理】</h5><p>尽量采用W3C DOM 的写法，访问对象的时候，用document.getElementById(“id”) 以ID来访问对象，且一个ID在页面中必须是唯一的，同样在以标签名来访问对象的时候，用document.getElementsByTagName(“div”)[0] 。该方式得到较多浏览器的支持。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;lt;input id=<span class="string">"id"</span> type=<span class="string">"button"</span> value=<span class="string">"click me"</span> onclick=<span class="string">"alert(document.getElementById('id').value)"</span> /&amp;gt;</span><br></pre></td></tr></table></figure>
<h3 id="集合类对象访问"><a href="#集合类对象访问" class="headerlink" title="集合类对象访问"></a>集合类对象访问</h3><p>IE下，可以使用()或[]获取集合类对象；Firefox下，只能使用[]获取集合类对象。如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.write(<span class="built_in">document</span>.forms(<span class="string">"formName"</span>).src);</span><br><span class="line"><span class="comment">//该写法在IE下能访问到Form对象的scrc属性</span></span><br></pre></td></tr></table></figure>
<h5 id="【兼容处理】-9"><a href="#【兼容处理】-9" class="headerlink" title="【兼容处理】"></a>【兼容处理】</h5><p>统一使用[]获取集合类对象。</p>
<h3 id="frame的引用"><a href="#frame的引用" class="headerlink" title="frame的引用"></a>frame的引用</h3><p>IE可以通过id或者name访问这个frame对应的window对象，而Firefox只可以通过name来访问这个frame对应的window对象。</p>
<h5 id="【兼容处理】-10"><a href="#【兼容处理】-10" class="headerlink" title="【兼容处理】"></a>【兼容处理】</h5><p>使用frame的name来访问frame对象，另外，在IE和Firefox中都可以使用window.document.getElementById(”frameId”)来访问这个frame对象。</p>
<h3 id="parentElement"><a href="#parentElement" class="headerlink" title="parentElement"></a>parentElement</h3><p>IE中支持使用parentElement和parentNode获取父节点。而Firefox只可以使用parentNode。</p>
<h5 id="【兼容处理】-11"><a href="#【兼容处理】-11" class="headerlink" title="【兼容处理】"></a>【兼容处理】</h5><p>因为firefox与IE都支持DOM，因此统一使用parentNode来访问父节点。</p>
<h3 id="table操作"><a href="#table操作" class="headerlink" title="table操作"></a>table操作</h3><p>IE下table中无论是用innerHTML还是appendChild插入&lt;tr&gt;都没有效果，而其他浏览器却显示正常。</p>
<h5 id="【兼容处理】-12"><a href="#【兼容处理】-12" class="headerlink" title="【兼容处理】"></a>【兼容处理】</h5><p>解决的方法是，将&lt;tr&gt;加到table的&lt;tbody&gt;元素中，如下面所示：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> row = <span class="built_in">document</span>.createElement(<span class="string">"tr"</span>);</span><br><span class="line"><span class="keyword">var</span> cell = <span class="built_in">document</span>.createElement(<span class="string">"td"</span>);</span><br><span class="line"><span class="keyword">var</span> cell_text = <span class="built_in">document</span>.createTextNode(<span class="string">"插入的内容"</span>);</span><br><span class="line">cell.appendChild(cell_text);</span><br><span class="line">row.appendChild(cell);</span><br><span class="line"><span class="built_in">document</span>.getElementsByTagName(<span class="string">"tbody"</span>)[<span class="number">0</span>].appendChild(row);</span><br></pre></td></tr></table></figure>
<h3 id="移除节点removeNode-和removeChild"><a href="#移除节点removeNode-和removeChild" class="headerlink" title="移除节点removeNode()和removeChild()"></a>移除节点removeNode()和removeChild()</h3><p>appendNode在IE和Firefox下都能正常使用，但是removeNode只能在IE下用。<br>removeNode方法的功能是删除一个节点，语法为node.removeNode（false）或者node.removeNode（true），返回值是被删除的节点。<br>removeNode（false）表示仅仅删除指定节点，然后这个节点的原孩子节点提升为原双亲节点的孩子节点。<br>removeNode（true）表示删除指定节点及其所有下属节点。被删除的节点成为了孤立节点，不再具有有孩子节点和双亲节点。</p>
<h5 id="【兼容处理】-13"><a href="#【兼容处理】-13" class="headerlink" title="【兼容处理】"></a>【兼容处理】</h5><p>Firefox中节点没有removeNode方法，只能用removeChild方法代替，先回到父节点，在从父节点上移除要移除的节点。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node.parentNode.removeChild(node); </span><br><span class="line"><span class="comment">// 为了在ie和firefox下都能正常使用，取上一层的父结点，然后remove。</span></span><br></pre></td></tr></table></figure>
<h3 id="childNodes获取的节点"><a href="#childNodes获取的节点" class="headerlink" title="childNodes获取的节点"></a>childNodes获取的节点</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&amp;lt;ul id=<span class="string">"main"</span>&amp;gt; </span><br><span class="line">  &amp;lt;li&amp;gt;<span class="number">1</span>&amp;lt;<span class="regexp">/li&amp;gt;</span></span><br><span class="line"><span class="regexp">  &amp;lt;li&amp;gt;2&amp;lt;/</span>li&amp;gt;</span><br><span class="line">  &amp;lt;li&amp;gt;<span class="number">3</span>&amp;lt;<span class="regexp">/li&amp;gt;</span></span><br><span class="line"><span class="regexp">&amp;lt;/u</span>l&amp;gt; </span><br><span class="line">&amp;lt;input type=button value=<span class="string">"click me!"</span> onclick=<span class="string">"alert(document.getElementById('main').childNodes.length)"</span>&amp;gt;</span><br></pre></td></tr></table></figure>
<p>分别用IE和Firefox运行，IE的结果是3，而Firefox则是7。Firefox使用DOM规范，”#text”表示文本（实际是无意义的空格和换行等）在Firefox里也会被解析成一个节点，在IE里只有有实际意义的文本才会解析成”#text”。</p>
<h5 id="【兼容处理】-14"><a href="#【兼容处理】-14" class="headerlink" title="【兼容处理】"></a>【兼容处理】</h5><p>方法一，获取子节点时，可以通过node.getElementsByTagName()来回避这个问题。但是 getElementsByTagName对复杂的DOM结构遍历明显不如用childNodes，因为childNodes能更好的处理DOM的层次结构。</p>
<p>方法二，在实际运用中，Firefox在遍历子节点时，不妨在for循环里加上：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(childNode.nodeName==<span class="string">"#text"</span>) <span class="keyword">continue</span>;<span class="comment">//或者使用nodeType == 1。</span></span><br></pre></td></tr></table></figure>
<h3 id="Firefox不能对innerText支持"><a href="#Firefox不能对innerText支持" class="headerlink" title="Firefox不能对innerText支持"></a>Firefox不能对innerText支持</h3><p>Firefox不支持innerText，它支持textContent来实现innerText，不过textContent没有像innerText一样考虑元素的display方式，所以不完全与IE兼容。如果不用textContent，字符串里面不包含HTML代码也可以用innerHTML代替。</p>
<h5 id="【兼容处理】-15"><a href="#【兼容处理】-15" class="headerlink" title="【兼容处理】"></a>【兼容处理】</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="built_in">document</span>.all)&#123;</span><br><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">'element'</span>).innerText = <span class="string">"my text"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">'element'</span>).textContent = <span class="string">"my text"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/10/20/css-performance/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SpeMoon">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="人在江湖漂">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/10/20/css-performance/" itemprop="url">CSS性能调优</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2011-10-20T00:00:00+08:00">2011-10-20</time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/css/" itemprop="url" rel="index">
                    <span itemprop="name">css</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>Web 开发中经常会遇到性能的问题，尤其是 Web 2.0 的应用。CSS 代码是控制页面显示样式与效果的最直接“工具”，但是在性能调优时他们通常被 Web 开发工程师所忽略，而事实上不规范的 CSS 会对页面渲染的效率有严重影响，尤其是对于结构复杂的 Web 2.0 页面，这种影响更是不可磨灭。所以，写出规范的、高性能的 CSS 代码会极大的提高应用程序的效率。本文主要来探讨一下如何优化，以及从哪些方面优化应用程序的 CSS 代码，从而最大限度的提高 Web 应用的性能。</p>
<p>CSS 代码的分析与渲染都是由浏览器来完成的，所以，了解浏览器的 CSS 工作机制对我们的优化有至关重要的作用。这篇文章我们主要从如下几个方面入手来介绍一下 CSS 的性能优化：</p>
<p>1.Style 标签的相关调优<br>2.特殊的 CSS 样式使用方式<br>3.CSS 缩写<br>4.CSS 的声明<br>5.CSS 选择器</p>
<h3 id="把-Stylesheets-放在-HTML-页面头部："><a href="#把-Stylesheets-放在-HTML-页面头部：" class="headerlink" title="把 Stylesheets 放在 HTML 页面头部："></a>把 Stylesheets 放在 HTML 页面头部：</h3><p>浏览器在所有的 stylesheets 加载完成之后，才会开始渲染整个页面，在此之前，浏览器不会渲染页面里的任何内容，页面会一直呈现空白。这也是为什么要把 stylesheet 放在头部的原因。如果放在 HTML 页面底部，页面渲染就不仅仅是在等待 stylesheet 的加载，还要等待 html 内容加载完成，这样一来，用户看到页面的时间会更晚。</p>
<p>对于 @import 和 &lt;link&gt; 两种加载外部 CSS 文件的方式：@import 就相当于是把 &lt;link&gt; 标签放在页面的底部，所以从优化性能的角度看，应该尽量避免使用 @import 命令</p>
<h3 id="避免使用-CSS-Expressions："><a href="#避免使用-CSS-Expressions：" class="headerlink" title="避免使用 CSS Expressions："></a>避免使用 CSS Expressions：</h3><p>参考下述代码：</p>
<h4 id="清单-1-CSS-Expression-案例"><a href="#清单-1-CSS-Expression-案例" class="headerlink" title="清单 1. CSS Expression 案例"></a>清单 1. CSS Expression 案例</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">Background-color</span>: <span class="selector-tag">expression</span>( (<span class="selector-tag">new</span> <span class="selector-tag">Date</span>())<span class="selector-class">.getHours</span>()%2 ? "<span class="selector-id">#B8D4FF</span>" : "<span class="selector-id">#F08A00</span>" )</span><br></pre></td></tr></table></figure>
<p>Expression 只有 IE 支持，而且他的执行比大多数人想象的要频繁的多。不仅页面渲染和改变大小 (resize) 时会执行，页面滚动 (scroll) 时也会执行，甚至连鼠标在页面上滑动时都会执行。在 expression 里面加上一个计数器就会知道，expression 的执行上相当频繁的。鼠标的滚动很容易就会使 expression 的执行次数超过 10000。</p>
<h5 id="避免使用-Filter："><a href="#避免使用-Filter：" class="headerlink" title="避免使用 Filter："></a>避免使用 Filter：</h5><p>IE 特有的 AlphaImageLoader filter 是为了解决 IE6 及以前版本不支持半透明的 PNG 图片而存在的。但是浏览器在下载 filter 里面的图片时会“冻结”浏览器，停止渲染页面。同时 filter 也会增大内存消耗。最不能忍受的是 filter 样式在每个页面元素（使用到该 filter 样式）渲染时都会被浏览器分析一次，而不是像一般的背景图片渲染模式：使用过该背景图片的所有元素都是被浏览器一次性渲染的。</p>
<p>针对这种情况，最好的解决办法就是使用 PNG8。</p>
<h5 id="CSS-缩写："><a href="#CSS-缩写：" class="headerlink" title="CSS 缩写："></a>CSS 缩写：</h5><p>CSS 缩写可以让你用极少的代码定义一系列样式属性，这种做法可以极大程度的缩减代码量以达到提高性能的目的。</p>
<h3 id="清单-2-Colour-缩写"><a href="#清单-2-Colour-缩写" class="headerlink" title="清单 2. Colour 缩写"></a>清单 2. Colour 缩写</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#000000</span>     <span class="selector-tag">------</span>&gt;&gt;     <span class="selector-id">#000</span> </span><br><span class="line"><span class="selector-id">#336699</span>     <span class="selector-tag">------</span>&gt;&gt;     <span class="selector-id">#369</span></span><br></pre></td></tr></table></figure>
<p>关于颜色，重复的属性值可以省略。</p>
<h3 id="清单-3-各种缩写方式"><a href="#清单-3-各种缩写方式" class="headerlink" title="清单 3. 各种缩写方式"></a>清单 3. 各种缩写方式</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">Margin-top</span>: 2<span class="selector-tag">px</span>; </span><br><span class="line"><span class="selector-tag">Margin-right</span>: 5<span class="selector-tag">px</span>; </span><br><span class="line"><span class="selector-tag">Margin-bottom</span>: 2<span class="selector-tag">em</span>; </span><br><span class="line"><span class="selector-tag">Margin-left</span>: 15<span class="selector-tag">px</span>;     <span class="selector-tag">-----</span>&gt;&gt;     <span class="selector-tag">Margin</span>: 2<span class="selector-tag">px</span> 5<span class="selector-tag">px</span> 2<span class="selector-tag">em</span> 15<span class="selector-tag">px</span>; </span><br><span class="line"></span><br><span class="line"><span class="selector-tag">Border-width</span>: 1<span class="selector-tag">px</span>; </span><br><span class="line"><span class="selector-tag">Border-style</span>: <span class="selector-tag">solid</span>; </span><br><span class="line"><span class="selector-tag">Border-color</span>: <span class="selector-id">#000</span>     <span class="selector-tag">-----</span>&gt;&gt;     <span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#000</span> </span><br><span class="line"></span><br><span class="line"><span class="selector-tag">Font-style</span>: <span class="selector-tag">italic</span>; </span><br><span class="line"><span class="selector-tag">Font-variant</span>: <span class="selector-tag">small-caps</span>; </span><br><span class="line"><span class="selector-tag">Font-weight</span>: <span class="selector-tag">bold</span>; </span><br><span class="line"><span class="selector-tag">Font-size</span>: 1<span class="selector-tag">em</span>; </span><br><span class="line"><span class="selector-tag">Line-height</span>: 140%; </span><br><span class="line"><span class="selector-tag">Font-family</span>: <span class="selector-tag">sans-serif</span>;  <span class="selector-tag">-----</span>&gt;&gt;  <span class="selector-tag">font</span>: <span class="selector-tag">italic</span> <span class="selector-tag">small-caps</span> <span class="selector-tag">bold</span> 1<span class="selector-tag">em</span> 140% <span class="selector-tag">sans-serief</span> </span><br><span class="line"></span><br><span class="line"><span class="selector-tag">Background-color</span>: <span class="selector-id">#f00</span>; </span><br><span class="line"><span class="selector-tag">Background-image</span>: <span class="selector-tag">url</span>(<span class="selector-tag">background</span><span class="selector-class">.gif</span>); </span><br><span class="line"><span class="selector-tag">Background-repeat</span>: <span class="selector-tag">no-repeat</span>; </span><br><span class="line"><span class="selector-tag">Background-attachment</span>: <span class="selector-tag">fixed</span>; </span><br><span class="line"><span class="selector-tag">Background-position</span>: 0 0; </span><br><span class="line"> <span class="selector-tag">-----</span>&gt;&gt;<span class="selector-tag">background</span>: <span class="selector-id">#f00</span> <span class="selector-tag">url</span>(<span class="selector-tag">background</span><span class="selector-class">.gif</span>) <span class="selector-tag">no-repeat</span> <span class="selector-tag">fixed</span> 0 0 </span><br><span class="line"></span><br><span class="line"><span class="selector-tag">list-style-type</span>: <span class="selector-tag">square</span>; </span><br><span class="line"><span class="selector-tag">list-style-position</span>: <span class="selector-tag">inside</span>; </span><br><span class="line"><span class="selector-tag">List-style-image</span>: <span class="selector-tag">url</span>(<span class="selector-tag">image</span><span class="selector-class">.gif</span>)  <span class="selector-tag">-----</span>&gt;&gt; <span class="selector-tag">list-style</span>: <span class="selector-tag">square</span> <span class="selector-tag">inside</span> <span class="selector-tag">url</span>(<span class="selector-tag">image</span><span class="selector-class">.gif</span>)</span><br></pre></td></tr></table></figure>
<h4 id="Multiple-Declarations"><a href="#Multiple-Declarations" class="headerlink" title="Multiple Declarations"></a>Multiple Declarations</h4><p>关于 CSS 的 class 声明和定义，也有简写的方式</p>
<h3 id="清单-4-Class-的声明"><a href="#清单-4-Class-的声明" class="headerlink" title="清单 4. Class 的声明"></a>清单 4. Class 的声明</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.Class1</span>&#123;<span class="attribute">position</span>: absolute; <span class="attribute">left</span>: <span class="number">20px</span>; <span class="attribute">top</span>: <span class="number">30px</span>;&#125; </span><br><span class="line"><span class="selector-class">.Class2</span>&#123;<span class="attribute">position</span>: absolute; <span class="attribute">left</span>: <span class="number">20px</span>; <span class="attribute">top</span>: <span class="number">30px</span>;&#125; </span><br><span class="line"><span class="selector-class">.Class3</span>&#123;<span class="attribute">position</span>: absolute; <span class="attribute">left</span>: <span class="number">20px</span>; <span class="attribute">top</span>: <span class="number">30px</span>;&#125; </span><br><span class="line"><span class="selector-class">.Class4</span>&#123;<span class="attribute">position</span>: absolute; <span class="attribute">left</span>: <span class="number">20px</span>; <span class="attribute">top</span>: <span class="number">30px</span>;&#125; </span><br><span class="line"><span class="selector-class">.Class5</span>&#123;<span class="attribute">position</span>: absolute; <span class="attribute">left</span>: <span class="number">20px</span>; <span class="attribute">top</span>: <span class="number">30px</span>;&#125; </span><br><span class="line"><span class="selector-class">.Class6</span>&#123;<span class="attribute">position</span>: absolute; <span class="attribute">left</span>: <span class="number">20px</span>; <span class="attribute">top</span>: <span class="number">30px</span>;&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="selector-class">.class1</span> <span class="selector-class">.class2</span> <span class="selector-class">.class3</span> <span class="selector-class">.class4</span> <span class="selector-class">.class5</span> <span class="selector-class">.class6</span>&#123; </span><br><span class="line"> <span class="attribute">Position</span>: absolute; <span class="attribute">left</span>: <span class="number">20px</span>; <span class="attribute">top</span>: <span class="number">20px</span>; </span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>这种 Class 简写的方式可以极大的缩减我们的代码，提高浏览器分析识别的效率。</p>
<h2 id="CSS-选择器-（CSS-Selectors）"><a href="#CSS-选择器-（CSS-Selectors）" class="headerlink" title="CSS 选择器 （CSS Selectors）"></a>CSS 选择器 （CSS Selectors）</h2><p>先来看看下面这个例子：</p>
<h3 id="清单-5-Child-selector"><a href="#清单-5-Child-selector" class="headerlink" title="清单 5. Child selector"></a>清单 5. Child selector</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#toc</span> &gt; <span class="selector-tag">li</span> &#123;<span class="attribute">font-weight</span>: bold&#125;</span><br></pre></td></tr></table></figure>
<p>按照我们惯常的理解，编译器应该是先查找 id 为“toc”的节点，然后在他的所有直接子节点中查找类型（tag）为“li”的节点，将“font-weight”属性应用到这些节点上。</p>
<p>但是，不幸的是，恰恰相反，浏览器是“从右往左”来分析 class 的，它的匹配规则是从右向左来进行匹配的。这里，浏览器首先会查找页面上所有的“li”节点，然后再去做进一步的判断：如果它的父节点的 id 为“toc”，则匹配成功。</p>
<p>由此可知，CSS 选择器的匹配远比我们想象的要慢的多，CSS 的性能问题不容忽视。</p>
<h3 id="清单-6-Descendant-selector"><a href="#清单-6-Descendant-selector" class="headerlink" title="清单 6. Descendant selector"></a>清单 6. Descendant selector</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#toc</span>  <span class="selector-tag">li</span> &#123;<span class="attribute">font-weight</span>: bold&#125;</span><br></pre></td></tr></table></figure>
<p>这个效率比之前的“child selector”效率更慢，而且要慢很多。浏览器先便利所有的“li”节点，然后步步上溯其父节点，直到 DOM 结构的根节点（document），如果有某个节点的 id 为“toc”，则匹配成功，否则继续查找下一个“li”节点。</p>
<h3 id="清单-7-尽量避免-universal-rules"><a href="#清单-7-尽量避免-universal-rules" class="headerlink" title="清单 7. 尽量避免 universal rules"></a>清单 7. 尽量避免 universal rules</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[hidden="true"] &#123; ... &#125; /* A universal rule */</span><br></pre></td></tr></table></figure>
<p>这里的匹配规则很明显：查找页面上的所有节点，如果有节点存在“hidden”属性，并且其属性值为“true”，则匹配成功。这是最耗时耗力的匹配，页面上的所有节点都需要进行匹配运算，这种规则应尽量避免。</p>
<h3 id="清单-8-Id-categorized-规则与-tag-name-或-class-规则并行"><a href="#清单-8-Id-categorized-规则与-tag-name-或-class-规则并行" class="headerlink" title="清单 8. Id-categorized 规则与 tag name 或 class 规则并行"></a>清单 8. Id-categorized 规则与 tag name 或 class 规则并行</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">button#goButton &#123;...&#125;;-----&gt;&gt;#goButton </span><br><span class="line">.fundation#testIcon &#123;...&#125;;-----&gt;&gt;#testIcon</span><br></pre></td></tr></table></figure>
<p>这里，按照我们常规的理解，箭头左边的写法似乎是应该更快的，因为它的限制更多。其实不然，id 是全局唯一的，在匹配 CSS 选择器时浏览器定位到 id 是最快的，如果伴随有其他的非 id 的 selector，反而会影响匹配的效率。</p>
<h3 id="清单-9-关于-class-categorized-规则"><a href="#清单-9-关于-class-categorized-规则" class="headerlink" title="清单 9. 关于 class-categorized 规则"></a>清单 9. 关于 class-categorized 规则</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">utton.indented &#123;...&#125;-----&gt;&gt;.button-indented &#123;...&#125;</span><br></pre></td></tr></table></figure>
<p>程序员们经常会给某个 Class 前面加上标签名称（Tag Name），以更精确且快速的定位该节点，但是这样往往效率更差。和清单 8 中的原理一样，页面上的 class 在全局范围内来讲应该是唯一的，用唯一的 Class 名称来定位一个节点往往比组合定位更加快捷。事实上，这种做法也可以避免由于开发修改页面元素的类型（Tag）而导致的样式失效的情况，做到样式与元素的分离，两者独立维护。</p>
<h3 id="清单-10-尽量减少规则数量"><a href="#清单-10-尽量减少规则数量" class="headerlink" title="清单 10. 尽量减少规则数量"></a>清单 10. 尽量减少规则数量</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Span[mailfolder="true"] &gt; table &gt; tr &gt; td.columnClass &#123;...&#125; </span><br><span class="line"></span><br><span class="line">.span-mailfolder-tbl-tdCol &#123;...&#125;</span><br></pre></td></tr></table></figure>
<p>规则越多，匹配越慢，上面一种规则需要进行 6 项匹配，先找“columnClass”，再找“td”，然后是“tr”，“table”，最后是符合“mailfolder”为“true”的 span，这种效率是非常慢的。如果用一个比较特殊的 class 替代（span-mailfolder-tbl-tdCol），效率会快上好几倍。</p>
<h3 id="清单-11-尽量避免使用-descendant-selector"><a href="#清单-11-尽量避免使用-descendant-selector" class="headerlink" title="清单 11. 尽量避免使用 descendant selector"></a>清单 11. 尽量避免使用 descendant selector</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">treehead treerow treecell &#123;...&#125; -----&gt;&gt; treehead &gt; treerow &gt; treecell &#123;...&#125;</span><br></pre></td></tr></table></figure>
<p>Descendant 选择器是耗时相对高的选择器，通常来讲，它在 CSS 里的使用应该是尽量避免的，如果能用 child 选择器替代就应该尽量这样去做。</p>
<h3 id="清单-12-利用-CSS-的继承机制"><a href="#清单-12-利用-CSS-的继承机制" class="headerlink" title="清单 12. 利用 CSS 的继承机制"></a>清单 12. 利用 CSS 的继承机制</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">Color</span> </span><br><span class="line"><span class="selector-tag">Font</span> </span><br><span class="line"><span class="selector-tag">Letter-spacing</span> </span><br><span class="line"><span class="selector-tag">Line-height</span> </span><br><span class="line"><span class="selector-tag">List-style</span> </span><br><span class="line"><span class="selector-tag">Text-align</span> </span><br><span class="line"><span class="selector-tag">Text-indent</span> </span><br><span class="line"><span class="selector-tag">Text-transform</span> </span><br><span class="line"><span class="selector-tag">White-space</span> </span><br><span class="line"><span class="selector-tag">Word-spacing</span> </span><br><span class="line"></span><br><span class="line"><span class="selector-id">#bookmark</span>  &gt; <span class="selector-class">.menu-left</span> &#123;<span class="attribute">list-style-image</span>: <span class="built_in">url</span>(blah)&#125; </span><br><span class="line"></span><br><span class="line"><span class="selector-tag">------------</span>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; </span><br><span class="line"></span><br><span class="line"><span class="selector-id">#bookmark</span>  &#123;<span class="attribute">list-style-image</span>: <span class="built_in">url</span>(blah)&#125;</span><br></pre></td></tr></table></figure>
<p>在 CSS 中，有很多 CSS 的属性以可以继承的，如果某个节点的父节点已经设定了上述的 CSS 样式（如：color, font 等 …），并且子节点无需更改该样式，则无需再作相关设定，同时，也可以利用这一点：如果很多子节点都需要设定该 CSS 属性值，可以统一设定其父节点的该 CSS 属性，这样一来，所有的子节点再无需做额外设定，加速了 CSS 的分析效率。</p>
<p><a href="http://www.ibm.com/developerworks/cn/web/1109_zhouxiang_optcss/index.html" target="_blank" rel="noopener">原文地址</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/09/20/ie-ff-box-resolve/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SpeMoon">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="人在江湖漂">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/09/20/ie-ff-box-resolve/" itemprop="url">IE与FF对盒模型的不同解析</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2011-09-20T00:00:00+08:00">2011-09-20</time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/css/" itemprop="url" rel="index">
                    <span itemprop="name">css</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>首先，单纯从页面显示的角度来说，IE和FF的和模型的现实宽度/高度，都等于width+padding+border+margin宽度/高度总和。</p>
<p>但是在剥削的属性里，FF仍然是本身width属性的宽度，而IE的width属性width+padding+border+margin宽度/高度总和</p>
<p>下面举例说明：</p>
<p>IE和FF对盒模型的解释也不一样，代码说明：</p>
<p>test { width: 650px !important;width: 648px;padding-left:2px;background:#fff; }</p>
<p>test 显示的宽度是 650px</p>
<p>IE Box的总宽度是：width+padding+border+margin宽度总和</p>
<p>FF Box的总宽度就是 width的宽度，padding+border+margin的宽度在含在width内。</p>
<p>如果有BOX{width:”300px”; padding:”5px”;}</p>
<p>则BOX在IE的宽度应该为:310px</p>
<p>而在FF的宽度则是:300px</p>
<p>所以在BOX有填充的情况下应该这样使用</p>
<p>BOX{width:”290″!IMPORTANT; width: “300″;}</p>
<p>这样子才能确保BOX的宽度始终在300px,而不会出现被撑开的现象</p>
<p>而在FF里面则不会造成浮动层填不满的情况</p>
<p>ul 标签在 Mozilla 中有 padding 值的，而在 IE 中只有 margin 有值。</p>
<p>设置ul{margin:0;padding:0}</p>
<p>IE和Mozilla浏览器对盒模型的解释不一致，造成定位上的困难，主要差别是：</p>
<p>1.IE计算2个div之间的距离时候，会把1px的border计算在内，而mozilla没有.</p>
<p>2.设定div的宽度后，如果给padding加一个值，IE5会在宽度内减去这个值，而Mozilla会在宽度基础上加上这个值。</p>
<p>针对firefox ie6 ie7的css样式</p>
<p>现在大部分都是用!important来hack，对于ie6和firefox测试可以正常显示，</p>
<p>但是ie7对!important可以正确解释，会导致页面没按要求显示!找到一个针</p>
<p>对IE7不错的hack方式就是使用“*+html”，现在用IE7浏览一下，应该没有问题了。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/09/06/css-priority/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SpeMoon">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="人在江湖漂">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/09/06/css-priority/" itemprop="url">CSS优先级</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2011-09-06T00:00:00+08:00">2011-09-06</time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/css/" itemprop="url" rel="index">
                    <span itemprop="name">css</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>所谓CSS优先级，即是指CSS样式在浏览器中被解析的先后顺序。</p>
<p>样式表中的特殊性描述了不同规则的相对权重，它的基本规则是：</p>
<p>统计选择符中的ID属性个数。<br>统计选择符中的CLASS属性个数。<br>统计选择符中的HTML标记名个数。</p>
<p>最后，按正确的顺序写出三个数字，不要加空格或逗号，得到一个三位数(css2.1是用4位数表示)。(注意，你需要把数字转换成一个以三个数字结尾的更大的数)。相应于选择符的最终数字列表可以很容易确定较高数字特性凌驾于较低数字的。</p>
<p>每个ID选择符(#someid)，加 0,1,0,0。<br>每个class选择符(.someclass)、每个属性选择符(形如[attr=value]等)、每个伪类(形如:hover等)加0,0,1,0。<br>每个元素或伪元素(:firstchild)等，加0,0,0,1。<br>其它选择符包括全局选择符*，加0,0,0,0。相当于没加，不过这也是一种specificity，后面会解释。</p>
<p><img src="../images/content/css_priority.jpg" alt="特性分类的选择符列表" title="特性分类的选择符列表"></p>
<p>通过上面，就可以很简单的看出，HTML标记的权重是1,CLASS的权重是10,ID的权重是100，继承的权重为0</p>
<p>按这些规则将数字符串逐位相加，就得到最终的权重，然后在比较取舍时按照从左到右的顺序逐位比较。</p>
<p>优先级问题其实就是一个冲突解决的问题，当同一个元素（内容）被CSS选择符选中时，就要按照优先级取舍不同的CSS规则，这其中涉及到的问题其实很多。</p>
<p>###CSS的继承性和继承的局限性###</p>
<p>继承是CSS的一个主要特征，它是依赖于祖先-后代的关系的。继承是一种机制，它允许样式不仅可以应用于某个特定的元素，还可以应用于它的后代。</p>
<p>有一些属性不能被继承，如：border, margin, padding, background等。</p>
<p>###附加说明###</p>
<p>文内的样式优先级为1,0,0,0，所以始终高于外部定义。这里文内样式指形如&lt;div style=”color:red”&gt;blah&lt;/div&gt;的样式，而外部定义指经由&lt;link&gt;或&lt;style&gt;卷标定义的规则。<br>有!important声明的规则高于一切。<br>如果!important声明冲突，则比较优先权。<br>如果优先权一样，则按照在源码中出现的顺序决定，后来者居上。<br>由继承而得到的样式没有specificity的计算，它低于一切其它规则(比如全局选择符*定义的规则)。<br>关于经由@import加载的外部样式，由于@import必须出现在所有其它规则定义之前(如不是，则浏览器应该忽略之)，所以按照后来居上原则，一般优先权冲突时是占下风的。</p>
<p>还需要说一下，IE是可以识别位置错误的@import的，但无论@import在什么地方，它都认为是位于所有其它规则定义之前的，这可能会引发一些误会。</p>
<p>优先权问题看起来简单，但背后还是有非常复杂的机制，在实际应用中需要多多留意。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/09/01/tag-property-semantic/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SpeMoon">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="人在江湖漂">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/09/01/tag-property-semantic/" itemprop="url">语义化标签和属性</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2011-09-01T00:00:00+08:00">2011-09-01</time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/html/" itemprop="url" rel="index">
                    <span itemprop="name">html</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>分离结构与表现的另一个重要方面是使用语义化的标记来构造文档内容。一个 XHTML 元素的存在就意味被标记内容的那部分有相应的结构化的意义，没有理由使用其他的标记。换句话说，不要让 CSS 使一个 HTML 元素看起来就像另一个 HTML 元素，比如用&lt;div&gt;来代替&lt;p&gt;标记标题。</p>
<p>首先是关于语义（Semantics）和默认样式的区别，默认样式是浏览器设定的一些常用tag的表现形式，个人认为他的主要目的就是让大家直观的认识标签(markup)和属性(attribute)的用途和作用，很明显Hx系列看起来很像标题，因为拥有粗体和较大的字号。&lt;strong&gt;,&lt;em&gt;用来区别于其他文字，起到了强调的作用。至于列表和表格很明显的告诉你他们是做什么的。</p>
<p>其次，语义化的网页的好处，最主要的就是对搜索引擎友好，又了良好的结构和语义你的网页内容自然容易被搜索引擎抓取，你网站的推广便可以省下不少的功夫。</p>
<p>具体的语义和用途在，XHTML1.0 TAG 参考中都已经说明，这里将一些容易遗忘或者混淆的TAGS和属性予以补充。</p>
<p>###&lt;Hx&gt;###</p>
<p>&lt;h1&gt;、&lt;h2&gt;、&lt;h3&gt;、&lt;h4&gt;、&lt;h5&gt;、&lt;h6&gt;,作为标题使用，并且依据重要性递减。&lt;h1&gt;是最高的等级。</p>
<p>例如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>文档标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>次级标题<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>而不要使用&lt;div class=”title”&gt;文档标题&lt;/div&gt;，或者&lt;span class=”title”&gt;文档标题&lt;/span&gt;.很明显搜索引擎对于后者是不会认为他是标题的。</p>
<p>###&lt;p&gt;###</p>
<p>段落标记，知道了&lt;p&gt;作为段落，你就不会再使用&lt;br/&gt;来换行了，而且不需要&lt;br/&gt;&lt;br/&gt;来区分段落与段落。&lt;p&gt;&lt;/p&gt;中的文字会自动换行，而且换行的效果优于&lt;br /&gt;。段落与段落之间的空隙也可以利用CSS来控制，很容易而且清晰的区分出段落与段落。在利用行高(line-height)很容易的定义出行间距，再定义首字下沉等效果，那就挺完美了。</p>
<p>例如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>这是一个段落哦~~<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>###&lt;ul&gt;、&lt;ol&gt;、&lt;li&gt;###</p>
<p>&lt;ul&gt;无序列表，很常见的到了大家广泛的使用，&lt;ol&gt;有序列表也挺常用。在web标准化过程中，&lt;ul&gt;还被更多的用于导航条，本来导航条就是个列表，这样做是完全正确的，而且当你的浏览器不支持CSS的时候，导航链接仍然很好使，就是美观方面差了一点。</p>
<p>例如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>项目一<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>项目二<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>项目三<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>项目一<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>项目二<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>项目三<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>###&lt;dl&gt;、&lt;dt&gt;、&lt;dd&gt;###</p>
<p>dl就是“定义列表”。比如说词典里面的词的解释、定义就可以用这种列表。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dl</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dt</span>&gt;</span>Dog<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dd</span>&gt;</span>A carnivorous mammal of the family Canidae.<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>###&lt;cite&gt;、&lt;q&gt;、&lt;blockquote&gt;###</p>
<p>论坛和blog经常会用到引用别人的话，用&lt;q&gt;来标记简短的单行引用。Web浏览器会自动识别在&lt;q&gt; 之间的内容。不幸的是，IE不能识别，并且有些时候， &lt;q&gt;会引起一些可访问性(Accessibility)的问题。正因为如此，一些人建议尽量不要使用 &lt;q&gt;,手动的插入引用标记。在一个包含适当的类的 &lt;span&gt;中加入单行的引用内容，那么就可以用CSS来给引用设计样式了，但是这个没有语义上的意义。</p>
<p>对于那些一段或者好几段的长篇引用，就应当使用 &lt;blockquote&gt;了。CSS可以用来定义引用的样式。注意，一段文章是不可以直接放在&lt;blockquote&gt;中的，引用的内容还必须包含在一个元素中，通常是&lt;p&gt;。属性cite既可以与&lt;q&gt; 一起用，也可以与&lt;blockquote&gt;一起用，用来提供引用内容的来源地址。需要注意的是，如果你使用&lt;span&gt;来代替 &lt;q&gt;标记引用内容,那么你就不能使用 cite属性了。例如:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">cite</span>&gt;</span>Designing with Web Standards<span class="tag">&lt;/<span class="name">cite</span>&gt;</span> is an excellent book by Jeffrey Zeldman.</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span> <span class="tag">&lt;<span class="name">cite</span>&gt;</span>孔子<span class="tag">&lt;/<span class="name">cite</span>&gt;</span>曰：<span class="tag">&lt;<span class="name">q</span>&gt;</span>学而不思则罔，思而不学则殆<span class="tag">&lt;/<span class="name">q</span>&gt;</span>.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>The W3C says that <span class="tag">&lt;<span class="name">q</span> <span class="attr">cite</span>=<span class="string">"http://www.w3.org/TR/REC-html40/struct/text.html#h-9.2.1"</span>&gt;</span>The presentation of phrase elements depends on the user agent.<span class="tag">&lt;/<span class="name">q</span>&gt;</span>.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">blockquote</span> <span class="attr">cite</span>=<span class="string">"http://www.w3cn.org/"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>“我们大部分人都有深刻体验，每当主流浏览器版本的升级，我们刚建立的网站就可能变得过时，我们就需要升级或者重新建造一遍网站。例如1996-1999年典型的"浏览器大战"，为了兼容 Netscape 和 IE，网站不得不为这两种浏览器写不同的代码。同样的，每当新的网络技术和交互设备的出现，我们</span><br><span class="line">也需要制作一个新版本来支持这种新技术或新设备，例如支持手机上网的 WAP 技术。类似的问题举不胜举：网站代码臃肿、繁杂浪费了我们大量的带宽；针对某种浏览器的 DHTML 特效，屏蔽了部分潜在的客户；不易用的代码，残障人士无法浏览网站等等。这是一种恶性循环，是一种巨大的浪费。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">blockquote</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>###&lt;em&gt;、&lt;strong&gt;###</p>
<p>&lt;em&gt; 是用作强调的，&lt;strong&gt;是用作重点强调的。 大部分浏览器用斜体显示强调的内容，用粗体来显示重点强调的内容，然而，这是没有必要的，如果是为了确定强调内容的显示方式，最好的方法就是使用CSS来定义他们的表现。当你想要的只是视觉上的效果时，就不要使用强调了。而且如果你想要强调但是还觉得粗体或者斜体不视觉效果没那么好，特别是斜体对于中文来说，那么你完全可以定义一些其他的比较醒目的样式达到强调的效果。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">em</span>&gt;</span>强调<span class="tag">&lt;/<span class="name">em</span>&gt;</span> 的文本通常用斜体显示，然而，<span class="tag">&lt;<span class="name">strong</span>&gt;</span>特别强调<span class="tag">&lt;/<span class="name">strong</span>&gt;</span> 的文本通常以粗体显示。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>###&lt;table&gt;、&lt;td&gt;、&lt;th&gt;、&lt;caption&gt;、summary###</p>
<p>XHTML中的表格不应用来布局。然而如果是为了标记列表的数据，就应该使用表格了。&lt;th&gt;为表格标题，属性summar为摘要，&lt;caption&gt;标签为首部说明，&lt;thead&gt;标签为表格头部，&lt;tbody&gt;标签为表格主体内容，&lt;tfoot&gt;标签为表格尾部。</p>
<p>其中还可以使用scope 可用于取代headers属性，标记含有表头信息的单元格，其中各数值的内容如下：</p>
<p>row 指示当前单元格，为包含当前单元格的行提供相关的表头信息。</p>
<p>col 指示当前单元格，为根据当前单元格指定的列提供相应的表头信息。</p>
<p>rowgroup 指示当前单元格，为包含当前单元格的其余行组提供相关的表头信息。</p>
<p>colgroup 指示当前单元格，为根据当前单元格指定的其余列组提供相应的表头信息。</p>
<p>abbr 用于定义表头单元格中的缩写名，如果没有定义该属性，则将默认单元格内容为节略形式。</p>
<p>###&lt;dfn&gt;###</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">dfn</span> <span class="attr">title</span>=<span class="string">"Microsoft web browser"</span>&gt;</span>Internet Explorer<span class="tag">&lt;/<span class="name">dfn</span>&gt;</span> is the most popular browser used underwater.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>###&lt;ins&gt;, &lt;del&gt;###</p>
<p>知道del，就不要再用&lt;s&gt;做删除线了，用del显然更具有语义化。而且del还带有cite和datetime来表明删除的原因以及删除的时间。ins是表示插入，也有这样的属性。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>It really was <span class="tag">&lt;<span class="name">ins</span> <span class="attr">cite</span>=<span class="string">"rarara.html"</span> <span class="attr">datetime</span>=<span class="string">"20031024"</span>&gt;</span>very<span class="tag">&lt;/<span class="name">ins</span>&gt;</span> good.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>###&lt;code&gt;###</p>
<p>表示是计算机代码。而默认样式为打字体。技术论坛和blog中经常遇到。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">code</span>&gt;</span>p&#123;margin:2px 0;&#125;<span class="tag">&lt;/<span class="name">code</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>###&lt;abbr&gt;、&lt;acronym&gt;###</p>
<p>&lt;abbr&gt;标签是表示web页面上的简称，&lt;acronym&gt;标签为取首字母缩写。（注：这里把简称和缩写分开而论，简称范围比缩写大，取首字母的缩写用&lt;acronym&gt;标签）Windows的IE6.0以下的浏览器暂不支持&lt;abbr&gt;标签。 在IE里，你可以应用CSS给&lt;acronym&gt;但是不能应用给&lt;abbr&gt;标签，IE会为&lt;acronym&gt;标签的title属性显示提示，但是会忽略&lt;abbr&gt;标签。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">abbr</span> <span class="attr">title</span>=<span class="string">"Cascading Style Sheets"</span>&gt;</span>CSS<span class="tag">&lt;/<span class="name">abbr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">acronym</span> <span class="attr">title</span>=<span class="string">"Cascading Style Sheets"</span>&gt;</span>CSS<span class="tag">&lt;/<span class="name">acronym</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>###alt属性和title属性###</p>
<p>title属性用来为元素提供额外说明信息title属性可以用在除了base，basefont，head，html，meta，param，script和title之外的所有标签。但是并不是必须的。</p>
<p>alt属性为不能显示图像、窗体或applets的用户代理（UA），指定替换文字。替换文字的语言由lang属性指定。<br>只需要一行语句把生产者、过滤器和消费者串联起来就可以创建出一个管道：</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/08/27/html-resolve-principle/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SpeMoon">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="人在江湖漂">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/08/27/html-resolve-principle/" itemprop="url">HTML解析原理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2011-08-27T00:00:00+08:00">2011-08-27</time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/html/" itemprop="url" rel="index">
                    <span itemprop="name">html</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Web页面运行在各种各样的浏览器当中，浏览器载入、渲染页面的速度直接影响着用户体验。</p>
<p>简单地说，页面渲染就是浏览器将html代码根据CSS定义的规则显示在浏览器窗口中的这个过程。先来大致了解一下浏览器都是怎么干活的：</p>
<ol>
<li><p>用户输入网址（假设是个html页面，并且是第一次访问），浏览器向服务器发出请求，服务器返回html文件；</p>
</li>
<li><p>浏览器开始载入html代码，发现&lt;head&gt;标签内有一个&lt;link&gt;标签引用外部CSS文件；</p>
</li>
<li><p>浏览器又发出CSS文件的请求，服务器返回这个CSS文件；</p>
</li>
<li><p>浏览器继续载入html中&lt;body&gt;部分的代码，并且CSS文件已经拿到手了，可以开始渲染页面了；</p>
</li>
<li><p>浏览器在代码中发现一个&lt;img&gt;标签引用了一张图片，向服务器发出请求。此时浏览器不会等到图片下载完，而是继续渲染后面的代码；</p>
</li>
<li><p>服务器返回图片文件，由于图片占用了一定面积，影响了后面段落的排布，因此浏览器需要回过头来重新渲染这部分代码；</p>
</li>
<li><p>浏览器发现了一个包含一行Javascript代码的&lt;script&gt;标签，赶快运行它；</p>
</li>
<li><p>Javascript脚本执行了这条语句，它命令浏览器隐藏掉代码中的某个&lt;div&gt; (style.display=”none”)。杯具啊，突然就少了这么一个元素</p>
</li>
<li><p>终于等到了&lt;/html&gt;的到来，浏览器泪流满面……</p>
</li>
<li><p>等等，还没完，用户点了一下界面中的“换肤”按钮，Javascript让浏览器换了一下&lt;link&gt;标签的CSS路径；</p>
</li>
<li><p>浏览器召集了在座的各位&lt;div&gt;&lt;span&gt;&lt;ul&gt;&lt;li&gt;们，“大伙儿收拾收拾行李，咱得重新来过……”，浏览器向服务器请求了新的CSS文件，重新渲染页面。<br>说到页面为什么会慢？那是因为浏览器要花时间、花精力去渲染，尤其是当它发现某个部分发生了点变化影响了布局，需要倒回去重新渲染，内行称这个回退的过程叫reflow。</p>
<p><img src="../images/content/reflow.jpg" alt="reflow图解" title="reflow图解"></p>
</li>
</ol>
<p>reflow几乎是无法避免的。现在界面上流行的一些效果，比如树状目录的折叠、展开（实质上是元素的显示与隐藏）等，都将引起浏览器的 reflow。鼠标滑过、点击……只要这些行为引起了页面上某些元素的占位面积、定位方式、边距等属性的变化，都会引起它内部、周围甚至整个页面的重新渲染。通常我们都无法预估浏览器到底会reflow哪一部分的代码，它们都彼此相互影响着。</p>
<p> <img src="../images/content/repaint.jpg" alt="repaint图解" title="repaint图解"></p>
<p>reflow问题是可以优化的，我们可以尽量减少不必要的reflow。比如开头的例子中的图片载入问题，这其实就是一个可以避免的reflow——给图片设置宽度和高度就可以了。这样浏览器就知道了图片的占位面积，在载入图片前就预留好了位置。</p>
<p> 另外，有个和reflow看上去差不多的术语：repaint，中文叫重绘。如果只是改变某个元素的背景色、文字颜色、边框颜色等等不影响它周围或内部布局的属性，将只会引起浏览器repaint。repaint的速度明显快于reflow（在IE下需要换一下说法，reflow要比repaint 更缓慢）。下次将通过一系列的实验说明在Firefox、IE等浏览器下reflow的优化。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">SpeMoon</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">32</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    <span class="site-state-item-count">59</span>
                    <span class="site-state-item-name">分类</span>
                  
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    <span class="site-state-item-count">49</span>
                    <span class="site-state-item-name">标签</span>
                  
                </div>
              
            </nav>
          

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">SpeMoon</span>

  

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Muse</a> v6.0.0</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.0.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.0.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.0.0"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
